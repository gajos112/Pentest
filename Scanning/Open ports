1. hping2
2. Unicornscan
3. Nmap
4. Netcat

Port scanning is primarily divided into two main categories:
- TCP scanning
- UDP scanning.

nmap <Scan Type> <Option> <Target Specification>
nmap 192.168.15.*


- Open — It means that the port is accessible and an application is listening on it.
- Closed — It means that the port is inaccessible and no application is listening on it.
- Filtered — It means that nmap is not able to figure out if the port is open or closed, as the packets
are being filtered, which probably means that the machine is behind a firewall.
- Unfiltered — It means that the ports are accessible by nmap but it is not possible to figure out if
they are open or closed.

////////////////////////////////////////////////////////SYN SCAN//////////////////////////////////////////

TCP SYN SCAN (-sS)
Source --SYN--> Target
Source <--SYN/ACK-- Target
Source --RST--> Target

///////////////////////////////////////////////////////CONNECT SCAN///////////////////////////////////////

TCP Connect SCAN (-sC)
Source --SYN--> Target
Source <--SYN/ACK-- Target
Source --SYN--> Target
Source --RST--> Target

NULL, FIN, and XMAS scans are similar to each other. Allow to bypas FW and IDS. Works against Unix-based OS. Windows send always 
RST even if port is open or closed.

/////////////////////////////////////////////////////////NULL SCAN/////////////////////////////////////////

NULL Scan (-sN)
Source --Null flag in TCP header--> Target
Source <--RST-- Target

No response = OPEN
RST = Closed or Filtered

///////////////////////////////////////////////////////////FIN SCAN//////////////////////////////////////////

FIN Scan (-sF)
Source --FIN--> Target

No response = OPEN
RST = Closed

//////////////////////////////////////////////////////////XMAS SCAN////////////////////////////////////////////

XMAS Scan (-sX)
Source --FIN,URG,PUSH--> Target

No response = OPEN
RST = Closed

///////////////////////////////////////////////////////////ACK SCAN///////////////////////////////////////////////

ACK Scan (-sA)
Source --ACK--> Target

No response = port is filtered (a stateful inspection firewall is present in this case)
RST = packet reached the destination.

////////////////////////////////////////////////////////////UDP SCAN////////////////////////////////////////////////

Scan sends an empty UDP header (-sU)

Response = port is open.
No response = port is open or filtered.
ICMP Port unreachable = port is closed
Other ICMP response = port is filtered.
response means that the port is filtered.

///////////////////////////////////////////////////////////IDLE SCAN////////////////////////////////////////////////////

IDLE SCAN (-sI -pN <IP Address Of Zombie> <IP Address Of The Target>)
-pN prevent nmap from sending an initial packet from your real IP to the target host.

///////////////OPEN PORT/////////////////
Situation for open ports:

1. Probe zombie IP ID
Source --SYN/ACK--> Zombie
Source --RST IP ID = 10001--> Zombie

2. Forge SYN packet with source IP of zombie host
Source --SYN Zombie IP in source filed--> Target
Zombie <--SYN/ACK-- Target
Zombie --RST IP ID = 10002--> Target

3. Probe zombie IP ID again
Source --SYN/ACK--> Zombie
Source --RST IP ID = 10003--> Zombie

///////////////CLOSED PORT/////////////////
Situation for closed ports:

1. Probe zombie IP ID
Source --SYN/ACK--> Zombie
Source --RST IP ID = 10001--> Zombie

2. Forge SYN packet with source IP of zombie host
Source --SYN Zombie IP in source filed--> Target
Zombie <--RST-- Target

3. Probe zombie IP ID again
Source --SYN/ACK--> Zombie
Source --RST IP ID = 10002--> Zombie

/////////////FILTERED PORT///////////////
Situation for closed ports:

1. Probe zombie IP ID
Source --SYN/ACK--> Zombie
Source --RST IP ID = 10001--> Zombie

2. Forge SYN packet with source IP of zombie host
Source --SYN Zombie IP in source filed--> Target
Zombie -->No reponse<-- Target

3. Probe zombie IP ID again
Source --SYN/ACK--> Zombie
Source --RST IP ID = 10002--> Zombie

The way to find vulnerable host which can be used as zombie
- hping2 –S –r <Target IP>
S—Sending a SYN flag
R—For the relative id

- msf> use auxiliary/scanner/ip/ipidseq

The otput will show if IP ID is chaning by one.

////////////////////////////////////////////////////////FTP Bounce SCAN////////////////////////////////////////////////

Scan sends an empty UDP header (-b)

This method allow to ask FTP server to send file to specific port on target machine. 
When transfer is completed then FTP server will response to us 226 transfere complete
